# Расчёт размера выборки для A/B-теста

## Контекст проекта
Проект выполнен в рамках подготовки к A/B-тестированию новых алгоритмов в приложении с новостной лентой. Перед запуском теста необходимо определить, сколько пользователей нужно в каждой группе, чтобы обнаружить ожидаемый эффект с достаточной мощностью. Данные получены из таблицы `feed_actions` в ClickHouse за период с 4 апреля по 5 июля 2025 года.

## Цель проекта
Оценить необходимый размер выборки для A/B-теста с помощью двух подходов:
- Аналитического — по классической формуле.
- Имитационного — методом Монте-Карло.
Цель — получить реалистичную и надёжную оценку длительности теста и минимально детектируемого эффекта (MDE).

## Стек
Python, pandas, numpy, scipy, matplotlib, ClickHouse

## Этапы работы
1. **Анализ исторических данных** — изучил распределение CTR по пользователям, оценил среднее и дисперсию.
2. **Расчёт по формуле** — применил стандартную формулу для размера выборки с параметрами: α = 0.05, β = 0.2, σ² — по историческим данным, ε = 0.01.
3. **Моделирование методом Монте-Карло**:
   - Разделил пользователей на две эквивалентные группы на основе A/A-теста.
   - В тестовую группу добавил искусственный эффект (например, +0.01 к CTR).
   - Провёл 1000 симуляций A/B-тестов при разных размерах выборки.
   - Для каждой выборки оценил долю значимых результатов (мощность).
4. **Определение минимального размера** — подобрал такое значение n, при котором мощность достигает 80%.

## Результат
Получены две оценки:
- По формуле — приближённая, но быстрая.
- По методу Монте-Карло — более точная, учитывающая реальное распределение метрики и возможную неравномерность эффекта.
Результаты могут быть использованы для планирования A/B-теста: определения его длительности и оценки технической реализуемости.
